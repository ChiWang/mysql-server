# engine=innodb
create table product (
category int not null,
id int not null,
price decimal,
primary key(category, id))
engine=innodb;
create table customer (
id int not null,
primary key (id))
engine=innodb;
create table product_order (
no int not null auto_increment,
product_category int not null,
product_id int not null,
customer_id int not null,
primary key(no),
index (product_category, product_id),
foreign key fk1 (product_category, product_id) references product(category, id)
on update restrict on delete cascade,
index (customer_id),
foreign key fk2 (customer_id) references customer(id))
engine=innodb;
create table emp (
id int primary key auto_increment,
manager int,
key (manager),
foreign key fk1 (manager) references emp (id))
engine=innodb;
select *
from information_schema.table_constraints
where table_schema = 'test'
order by table_name, constraint_type, constraint_name;
CONSTRAINT_CATALOG	CONSTRAINT_SCHEMA	CONSTRAINT_NAME	TABLE_SCHEMA	TABLE_NAME	CONSTRAINT_TYPE
def	test	PRIMARY	test	customer	PRIMARY KEY
def	test	emp_ibfk_1	test	emp	FOREIGN KEY
def	test	PRIMARY	test	emp	PRIMARY KEY
def	test	PRIMARY	test	product	PRIMARY KEY
def	test	product_order_ibfk_1	test	product_order	FOREIGN KEY
def	test	product_order_ibfk_2	test	product_order	FOREIGN KEY
def	test	PRIMARY	test	product_order	PRIMARY KEY
COL	ORDINAL_POSITION	POSITION_IN_UNIQUE_CONSTRAINT	REFERENCED_COL
customer.id	1	NULL	
emp.id	1	NULL	
emp.manager	1	1	emp.id
product.category	1	NULL	
product.id	2	NULL	
product_order.customer_id	1	1	customer.id
product_order.no	1	NULL	
product_order.product_category	1	1	product.category
product_order.product_id	2	2	product.id
drop table product_order, customer, product, emp;
# engine=ndb
create table product (
category int not null,
id int not null,
price decimal,
primary key(category, id))
engine=ndb;
create table customer (
id int not null,
primary key (id))
engine=ndb;
create table product_order (
no int not null auto_increment,
product_category int not null,
product_id int not null,
customer_id int not null,
primary key(no),
index (product_category, product_id),
foreign key fk1 (product_category, product_id) references product(category, id)
on update restrict on delete cascade,
index (customer_id),
foreign key fk2 (customer_id) references customer(id))
engine=ndb;
create table emp (
id int primary key auto_increment,
manager int,
key (manager),
foreign key fk1 (manager) references emp (id))
engine=ndb;
select *
from information_schema.table_constraints
where table_schema = 'test'
order by table_name, constraint_type, constraint_name;
CONSTRAINT_CATALOG	CONSTRAINT_SCHEMA	CONSTRAINT_NAME	TABLE_SCHEMA	TABLE_NAME	CONSTRAINT_TYPE
def	test	PRIMARY	test	customer	PRIMARY KEY
def	test	fk1	test	emp	FOREIGN KEY
def	test	PRIMARY	test	emp	PRIMARY KEY
def	test	PRIMARY	test	product	PRIMARY KEY
def	test	fk1	test	product_order	FOREIGN KEY
def	test	fk2	test	product_order	FOREIGN KEY
def	test	PRIMARY	test	product_order	PRIMARY KEY
COL	ORDINAL_POSITION	POSITION_IN_UNIQUE_CONSTRAINT	REFERENCED_COL
customer.id	1	NULL	
emp.id	1	NULL	
emp.manager	1	1	emp.id
product.category	1	NULL	
product.id	2	NULL	
product_order.customer_id	1	1	customer.id
product_order.no	1	NULL	
product_order.product_category	1	1	product.category
product_order.product_id	2	2	product.id
drop table product_order, customer, product, emp;
