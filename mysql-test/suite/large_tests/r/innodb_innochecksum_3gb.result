DROP TABLE IF EXISTS tab2;
SHOW variables like '%innodb_checksum_algorithm%';
Variable_name	Value
innodb_checksum_algorithm	innodb
SELECT @@default_storage_engine;
@@default_storage_engine
InnoDB
CREATE TABLE tab2(col_1 CHAR (255) ,
col_2 VARCHAR (255), col_3 longtext,
col_4 longtext,col_5 BLOB,
col_6 LONGBLOB , col_7 bigint)
engine = innodb ;
CREATE INDEX idx1 ON tab2(col_3(10));
CREATE INDEX idx2 ON tab2(col_4(10));
CREATE INDEX idx3 ON tab2(col_5(10));
#generate a input text file for loading the table
# check whether file exist
# load the data into the table
SELECT COUNT(*) FROM tab2;
COUNT(*)
7014000
#stop the server
#R07: rewrite the tab2.ibd file into new checksum=CRC32
#restart the DB server with default innodb_checksum_algorithm=InnoDB (Default)
# no need to pass to the server.
#load the with repeat function
SET @col_1 = repeat('A', 5);
SET @col_2 = repeat('B', 20);
SET @col_3 = repeat('D', 100);
SET @col_4 = repeat('E', 100);
SET @col_5 = repeat('F', 100);
SET @col_6 = repeat('G', 100);
#check the table status with DML
INSERT INTO tab2(col_1,col_2,col_3,col_4,col_5,col_6,col_7)
VALUES (@col_1,@col_2,@col_3,@col_4,@cl_5,@col_6,1000);
#check with Read operation by record count
SELECT COUNT(*) FROM tab2 where col_7=1000;
COUNT(*)
1
#stop the server
#R07: rewrite the tab2.ibd file into new checksum=None
#R07: Check the page type summary with longform for *.ibd

File::tab#.ibd
================PAGE TYPE SUMMARY==============
#PAGE_COUNT	PAGE_TYPE
===============================================
  #	INDEX PAGE
       #	UNDO LOG PAGE
       #	INODE PAGE
       #	INSERT BUFFER FREE LIST PAGE
    #	FRESHLY ALLOCATED PAGE
      #	INSERT BUFFER BITMAP
       #	SYSTEM PAGE
       #	TRANSACTION SYSTEM PAGE
       #	FILE SPACE HEADER
      #	EXTENT DESCRIPTOR
       #	BLOB PAGE
       #	COMPRESSED BLOB PAGE
       #	OTHER TYPE OF PAGE
===============================================
Additional information:
Undo page type: # insert, # update, # other
Undo page state: # active, # cached, # to_free, # to_purge, # prepared, # other
# Page type dump for tab2.ibd
# check whether dump.txt file exist
#restart the DB server with default innodb_checksum_algorithm=CRC32
SHOW variables like '%innodb_checksum_algorithm%';
Variable_name	Value
innodb_checksum_algorithm	crc32
#check the default engine is always InnoDB after restart
SELECT @@default_storage_engine;
@@default_storage_engine
InnoDB
#load the with repeat function
SET @col_1 = repeat('G', 5);
SET @col_2 = repeat('H', 20);
SET @col_3 = repeat('I', 100);
SET @col_4 = repeat('J', 100);
SET @col_5 = repeat('K', 100);
SET @col_6 = repeat('L', 100);
#check the table status with DML
INSERT INTO tab2(col_1,col_2,col_3,col_4,col_5,col_6,col_7)
VALUES (@col_1,@col_2,@col_3,@col_4,@cl_5,@col_6,2000);
#check with Read operation that record count
SELECT COUNT(*) FROM tab2 where col_7=2000;
COUNT(*)
1
#cleanup
DROP TABLE IF EXISTS tab2;
#TEST END
