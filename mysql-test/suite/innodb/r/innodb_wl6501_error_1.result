call mtr.add_suppression("Unable to truncate FTS index for table");
call mtr.add_suppression("Unable to assign a new identifier to table "
			 "\".*\"\.\".*\" after truncating it");
set global innodb_file_per_table = on;
"1. Error in assigning undo logs for truncate action."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_assigning_undo_log";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_assigning_undo_log";
select * from t;
i
1
2
3
drop table t;
"2. Error while preparing for truncate."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_preparing_for_truncate";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_preparing_for_truncate";
select * from t;
i
1
2
3
drop table t;
"3. Error while dropping/creating indexes"
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_drop_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_drop_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_create_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_create_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"4. Error while completing truncate of table involving FTS."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Antelope';
create  table t (i int, c char(NUMBER),
primary key pk(i), fulltext index ck(c))
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_fts_trunc";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_fts_trunc";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"5. Error while updating sys-tables."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Antelope';
create  table t (i int, c char(NUMBER),
primary key pk(i), index ck(c))
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t order by i;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_sys_table_update";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_sys_table_update";
select * from t order by i;
ERROR HY000: Index t is corrupted
drop table t;
set global innodb_file_format = Antelope;
set global innodb_file_per_table = 1;
call mtr.add_suppression("Unable to truncate FTS index for table");
call mtr.add_suppression("Unable to assign a new identifier to table "
			 "\".*\"\.\".*\" after truncating it");
set global innodb_file_per_table = on;
"1. Error in assigning undo logs for truncate action."
use test;
set global innodb_file_per_table = 0;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_per_table.
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_assigning_undo_log";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_assigning_undo_log";
select * from t;
i
1
2
3
drop table t;
"2. Error while preparing for truncate."
use test;
set global innodb_file_per_table = 0;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_per_table.
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_preparing_for_truncate";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_preparing_for_truncate";
select * from t;
i
1
2
3
drop table t;
"3. Error while dropping/creating indexes"
use test;
set global innodb_file_per_table = 0;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_per_table.
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_drop_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_drop_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
use test;
set global innodb_file_per_table = 0;
set global innodb_file_format = 'Antelope';
create  table t (i int)
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_per_table.
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_create_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_create_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"4. Error while completing truncate of table involving FTS."
use test;
set global innodb_file_per_table = 0;
set global innodb_file_format = 'Antelope';
create  table t (i int, c char(NUMBER),
primary key pk(i), fulltext index ck(c))
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_per_table.
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_fts_trunc";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_fts_trunc";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"5. Error while updating sys-tables."
use test;
set global innodb_file_per_table = 0;
set global innodb_file_format = 'Antelope';
create  table t (i int, c char(NUMBER),
primary key pk(i), index ck(c))
engine=innodb row_format=compact
key_block_size=NUMBER;
Warnings:
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_per_table.
Warning	NUMBER	InnoDB: KEY_BLOCK_SIZE requires innodb_file_format > Antelope.
Warning	NUMBER	InnoDB: ignoring KEY_BLOCK_SIZE=NUMBER.
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t order by i;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_sys_table_update";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_sys_table_update";
select * from t order by i;
ERROR HY000: Index t is corrupted
drop table t;
set global innodb_file_format = Antelope;
set global innodb_file_per_table = 1;
call mtr.add_suppression("Unable to truncate FTS index for table");
call mtr.add_suppression("Unable to assign a new identifier to table "
			 "\".*\"\.\".*\" after truncating it");
set global innodb_file_per_table = on;
"1. Error in assigning undo logs for truncate action."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_assigning_undo_log";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_assigning_undo_log";
select * from t;
i
1
2
3
drop table t;
"2. Error while preparing for truncate."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_preparing_for_truncate";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_preparing_for_truncate";
select * from t;
i
1
2
3
drop table t;
"3. Error while dropping/creating indexes"
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_drop_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_drop_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_create_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_create_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"4. Error while completing truncate of table involving FTS."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int, c char(NUMBER),
primary key pk(i), fulltext index ck(c))
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_fts_trunc";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_fts_trunc";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"5. Error while updating sys-tables."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int, c char(NUMBER),
primary key pk(i), index ck(c))
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t order by i;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_sys_table_update";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_sys_table_update";
select * from t order by i;
ERROR HY000: Index t is corrupted
drop table t;
set global innodb_file_format = Antelope;
set global innodb_file_per_table = 1;
call mtr.add_suppression("Unable to truncate FTS index for table");
call mtr.add_suppression("Unable to assign a new identifier to table "
			 "\".*\"\.\".*\" after truncating it");
set global innodb_file_per_table = on;
"1. Error in assigning undo logs for truncate action."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_assigning_undo_log";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_assigning_undo_log";
select * from t;
i
1
2
3
drop table t;
"2. Error while preparing for truncate."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_preparing_for_truncate";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_preparing_for_truncate";
select * from t;
i
1
2
3
drop table t;
"3. Error while dropping/creating indexes"
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_drop_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_drop_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_create_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_create_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"4. Error while completing truncate of table involving FTS."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int, c char(NUMBER),
primary key pk(i), fulltext index ck(c))
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_fts_trunc";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_fts_trunc";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"5. Error while updating sys-tables."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int, c char(NUMBER),
primary key pk(i), index ck(c))
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t order by i;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_sys_table_update";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_sys_table_update";
select * from t order by i;
ERROR HY000: Index t is corrupted
drop table t;
set global innodb_file_format = Antelope;
set global innodb_file_per_table = 1;
call mtr.add_suppression("Unable to truncate FTS index for table");
call mtr.add_suppression("Unable to assign a new identifier to table "
			 "\".*\"\.\".*\" after truncating it");
set global innodb_file_per_table = on;
"1. Error in assigning undo logs for truncate action."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_assigning_undo_log";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_assigning_undo_log";
select * from t;
i
1
2
3
drop table t;
"2. Error while preparing for truncate."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_preparing_for_truncate";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_preparing_for_truncate";
select * from t;
i
1
2
3
drop table t;
"3. Error while dropping/creating indexes"
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_drop_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_drop_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int)
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1), (2), (3);
select * from t;
i
1
2
3
set session debug = "+d,ib_err_trunc_create_index";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_create_index";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"4. Error while completing truncate of table involving FTS."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int, c char(NUMBER),
primary key pk(i), fulltext index ck(c))
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_fts_trunc";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_fts_trunc";
select * from t;
ERROR HY000: Index t is corrupted
drop table t;
"5. Error while updating sys-tables."
use test;
set global innodb_file_per_table = 1;
set global innodb_file_format = 'Barracuda';
create  table t (i int, c char(NUMBER),
primary key pk(i), index ck(c))
engine=innodb row_format=compressed
key_block_size=NUMBER;
insert into t values (1, 'mysql is now oracle company'),
(2, 'innodb is part of mysql'),
(3, 'innodb is default storage engine of mysql');
select * from t order by i;
i	c
1	mysql is now oracle company
2	innodb is part of mysql
3	innodb is default storage engine of mysql
set session debug = "+d,ib_err_trunc_during_sys_table_update";
truncate table t;
ERROR HY000: Got error -1 from storage engine
set session debug = "-d,ib_err_trunc_during_sys_table_update";
select * from t order by i;
ERROR HY000: Index t is corrupted
drop table t;
set global innodb_file_format = Antelope;
set global innodb_file_per_table = 1;
